{% extends "base.html" %}

{% block title %}–û–±—É—á–µ–Ω–∏–µ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - CyberGuardian{% endblock %}

{% block content %}
<div class="container">
    <div class="row mb-5">
        <div class="col-12 text-center">
            <h1 class="cyber-text glow-text mb-3">
                <i class="bi bi-book me-2"></i>–ö—É—Ä—Å—ã –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            </h1>
            <p class="cyber-subtext lead">
                –í—ã–±–µ—Ä–∏—Ç–µ –∫—É—Ä—Å –∏ –Ω–∞—á–Ω–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ. –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
            </p>
        </div>
    </div>

    <!-- –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å -->
    {% if current_user.is_authenticated %}
    <div class="row mb-4">
        <div class="col-12">
            <div class="cyber-card p-4">
                <h4 class="cyber-text mb-3">üìä –í–∞—à –æ–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å</h4>
                <div class="row">
                    {% for course_id, course in courses.items() %}
                    <div class="col-md-3 mb-3">
                        <div class="text-center">
                            <div class="progress-ring mx-auto mb-2" 
                                 style="--progress: {{ progress.get(course_id, {}).get('percentage', 0) }}%"
                                 data-progress="{{ progress.get(course_id, {}).get('percentage', 0) }}"></div>
                            <h6 class="cyber-text">{{ course.title }}</h6>
                            <small class="cyber-subtext">
                                {{ progress.get(course_id, {}).get('completed', 0) }}/{{ progress.get(course_id, {}).get('total', 0) }} —É—Ä–æ–∫–æ–≤
                            </small>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- –°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤ -->
    <div class="row g-4">
        {% for course_id, course in courses.items() %}
        <div class="col-lg-6">
            <div class="cyber-card p-4 h-100">
                <div class="d-flex align-items-start mb-3">
                    <i class="bi {{ course.icon }} display-4 text-cyber-primary me-3"></i>
                    <div class="flex-grow-1">
                        <h4 class="cyber-text mb-2">{{ course.title }}</h4>
                        <p class="cyber-subtext mb-2">{{ course.description }}</p>
                        <div class="d-flex gap-3 flex-wrap">
                            <span class="difficulty-badge difficulty-{{ course.difficulty }}">
                                {{ course.difficulty|title }}
                            </span>
                            <span class="cyber-subtext">
                                <i class="bi bi-clock"></i> {{ course.estimated_time }}
                            </span>
                            <span class="cyber-subtext">
                                <i class="bi bi-list-ul"></i> {{ course.modules|length }} –º–æ–¥—É–ª–µ–π
                            </span>
                        </div>
                    </div>
                </div>

                <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∫—É—Ä—Å–∞ -->
                <div class="mb-3">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <span class="cyber-subtext">–ü—Ä–æ–≥—Ä–µ—Å—Å:</span>
                        <span class="cyber-text">{{ progress.get(course_id, {}).get('percentage', 0) }}%</span>
                    </div>
                    <div class="cyber-progress">
                        <div class="cyber-progress-bar" style="width: {{ progress.get(course_id, {}).get('percentage', 0) }}%"></div>
                    </div>
                </div>

                <a href="{{ url_for('education.course_detail', course_id=course_id) }}" 
                   class="btn btn-cyber w-100">
                    {% if progress.get(course_id, {}).get('percentage', 0) == 0 %}
                    <i class="bi bi-play-circle me-2"></i>–ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ
                    {% elif progress.get(course_id, {}).get('percentage', 0) < 100 %}
                    <i class="bi bi-arrow-right-circle me-2"></i>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
                    {% else %}
                    <i class="bi bi-check-circle me-2"></i>–ü–æ–≤—Ç–æ—Ä–∏—Ç—å
                    {% endif %}
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<style>
.progress-ring {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: conic-gradient(var(--cyber-primary) 0% var(--progress, 0%), transparent var(--progress, 0%) 100%);
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

.progress-ring::before {
    content: attr(data-progress) '%';
    position: absolute;
    font-size: 0.8rem;
    font-weight: bold;
    color: var(--cyber-primary);
}

.progress-ring::after {
    content: '';
    position: absolute;
    width: 50px;
    height: 50px;
    background: var(--cyber-dark);
    border-radius: 50%;
}
</style>
{% endblock %}